{"ast":null,"code":"import _slicedToArray from\"C:/Users/Nirma/data/ap_2021_2022/it-project/ProjectAp2022/it-project-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import cookie from\"../../class/Cookie/Cookie\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var base=cookie.GetCookies(\"base\");var Login=function Login(_ref){var setAuth=_ref.setAuth,loggedin=_ref.loggedin;var _useState=useState({Email:\"\",Password:\"\"}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),err=_useState4[0],setErr=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),success=_useState6[0],setsuccess=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),errString=_useState8[0],setErrString=_useState8[1];var handleChange=function handleChange(event){// console.log(event.target.id);\n// this will dynamically select key position of the js object\nvar userHold={Email:\"\",Password:\"\"};// hold old values                            \nfor(var _i=0,_Object$entries=Object.entries(user);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];var p=key;userHold[p]=value;}var x=event.target.id;userHold[x]=event.target.value;setUser(userHold);};var send=function send(event){event.preventDefault();console.log(user);fetch(base+\"/api/Auth/login\",{method:'POST',// *GET, POST, PUT, DELETE, etc.\nmode:'cors',// no-cors, *cors, same-origin\n// cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached,\ncredentials:\"same-origin\",headers:{'Content-Type':'application/json',\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Headers\":\"Content-Type, Depth, User-Agent, X-File-Size, X-Requested-With, If-Modified-Since, X-File-Name, Cache-Control\",\"Access-Control-Allow-Methods\":\"OPTIONS, GET, POST\"},body:JSON.stringify(user)}).then(function(e){return e.json();}).then(function(e){console.log(e);if(e.hasError||typeof e.errors==\"object\"){var hold=[];if(typeof e.errors==\"object\"){for(var _i2=0,_Object$entries2=Object.entries(e.errors);_i2<_Object$entries2.length;_i2++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i2],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1];hold.push(\"-\"+key+\": \"+value);}}else{hold.push(e.error);}setErr(true);setErrString(hold);}else{setErr(false);}if(!e.hasError&&e.errors===undefined){cookie.SetCookie(\"auth\",\"true\",1);cookie.SetCookie(\"token\",e.token,1);console.log(e);setsuccess(true);setAuth(true);window.location.replace('home');}else{setsuccess(false);}}).catch(function(err){return console.log(err);});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6 col-sm-12 offset-md-3\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"exampleInputEmail1\",className:\"form-label\",children:\"Email address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",id:\"Email\",\"aria-describedby\":\"emailHelp\",onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"examplePasssword1\",className:\"form-label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"Password\",\"aria-describedby\":\"emailHelp\",onChange:handleChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",onClick:send,children:\"Log In\"})]})})})});};export default Login;","map":{"version":3,"names":["useState","cookie","base","GetCookies","Login","setAuth","loggedin","Email","Password","user","setUser","err","setErr","success","setsuccess","errString","setErrString","handleChange","event","userHold","Object","entries","key","value","p","x","target","id","send","preventDefault","console","log","fetch","method","mode","credentials","headers","body","JSON","stringify","then","e","json","hasError","errors","hold","push","error","undefined","SetCookie","token","window","location","replace","catch"],"sources":["C:/Users/Nirma/data/ap_2021_2022/it-project/ProjectAp2022/it-project-frontend/src/components/Login/LoginForm.tsx"],"sourcesContent":["import { ChangeEventHandler, MouseEventHandler, useReducer, useState } from \"react\";\r\nimport cookie from \"../../class/Cookie/Cookie\";\r\nimport ILoginUser from \"../../interface/ILoginForm/ILoginUser\";\r\nimport Alert from \"../Alert/Alert\";\r\nconst base =    cookie.GetCookies(\"base\");\r\ninterface LoginProps {\r\n    setAuth: React.Dispatch<React.SetStateAction<boolean>>\r\n    loggedin : boolean\r\n}\r\n\r\nconst Login=({setAuth,loggedin} : LoginProps)=>{\r\n\r\n    \r\n    const [user, setUser] = useState<ILoginUser>({\r\n        Email:  \"\",\r\n        Password:  \"\",\r\n    });\r\n\r\n    const [err,setErr] = useState<boolean>(false);\r\n    const [success,setsuccess] = useState<boolean>(false);\r\n    const [errString,setErrString] = useState<string[]>([]);\r\n\r\n    const handleChange: ChangeEventHandler<HTMLInputElement> = (event) => {\r\n       // console.log(event.target.id);\r\n       type ObjectKey = keyof typeof userHold; // this will dynamically select key position of the js object\r\n        let userHold:ILoginUser = {  Email:  \"\",\r\n                                        Password: \"\"\r\n                                    };\r\n\r\n         // hold old values                            \r\n        for (const [key, value] of Object.entries(user)) {\r\n            const  p  = key as ObjectKey\r\n            userHold[p] = value;\r\n        }                    \r\n        \r\n        const  x  = event.target.id as ObjectKey\r\n        userHold[x] = event.target.value;\r\n    \r\n        setUser(userHold);\r\n                            \r\n      }\r\n\r\n      const send :MouseEventHandler<HTMLButtonElement> = (event)=>{\r\n        \r\n        event.preventDefault()\r\n        console.log(user)\r\n            fetch(base+\"/api/Auth/login\",{\r\n             \r\n                    method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n                    mode: 'cors', // no-cors, *cors, same-origin\r\n                   // cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached,\r\n                   credentials:\"same-origin\",\r\n                   headers: {\r\n                    'Content-Type': 'application/json',\r\n                    \"Access-Control-Allow-Origin\": \"*\",\r\n                    \"Access-Control-Allow-Headers\": \"Content-Type, Depth, User-Agent, X-File-Size, X-Requested-With, If-Modified-Since, X-File-Name, Cache-Control\",\r\n                    \"Access-Control-Allow-Methods\": \"OPTIONS, GET, POST\"\r\n\r\n                  },\r\n                    body: JSON.stringify(user)\r\n                    \r\n            }).then(e=>e.json())\r\n            .then(e => {\r\n                \r\n                console.log(e)\r\n                if(e.hasError || typeof e.errors == \"object\"){\r\n\r\n                    let hold = [];\r\n                    if(typeof e.errors == \"object\"){\r\n                    for (const [key, value] of Object.entries(e.errors)) {\r\n                       hold.push(\"-\"+key+\": \"+value);\r\n                    }                   \r\n                 }else{\r\n                    hold.push(e.error );\r\n                 }\r\n                    \r\n                    setErr(true)\r\n\r\n                    setErrString(hold);\r\n                    \r\n\r\n\r\n                }else{\r\n                    setErr(false)\r\n                }\r\n\r\n                if(!e.hasError && e.errors === undefined){\r\n                    cookie.SetCookie(\"auth\",\"true\",1);\r\n                    cookie.SetCookie(\"token\",e.token,1);\r\n                    console.log(e)\r\n                    setsuccess(true)\r\n                    setAuth(true)\r\n                    window.location.replace('home');\r\n\r\n                }else{\r\n                    setsuccess(false)\r\n                }\r\n            })\r\n            .catch(err=> console.log(err))\r\n      }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    return(\r\n\r\n        <>\r\n                   <div className=\"row mt-5\">\r\n                    <div className=\"col-md-6 col-sm-12 offset-md-3\">\r\n                        <form action=\"\">\r\n                    \r\n                        <div className=\"mb-3\">\r\n                            <label htmlFor=\"exampleInputEmail1\" className=\"form-label\">Email address</label>\r\n                            <input type=\"email\" className=\"form-control\" id=\"Email\" aria-describedby=\"emailHelp\" onChange={handleChange}/>\r\n                        </div>\r\n\r\n                        <div className=\"mb-3\">\r\n                            <label htmlFor=\"examplePasssword1\" className=\"form-label\">Password</label>\r\n                            <input type=\"password\" className=\"form-control\" id=\"Password\" aria-describedby=\"emailHelp\" onChange={handleChange} />\r\n                        </div>\r\n\r\n                        <button type=\"submit\" className=\"btn btn-primary\" onClick={send}>Log In</button>\r\n                       \r\n                     \r\n                            \r\n                        </form>\r\n                      \r\n                    </div>\r\n                    \r\n                    \r\n                </div>\r\n        \r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module"}